<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Products Store</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { text-align: center; }
        input { padding: 8px; width: 300px; margin: 10px auto; display: block; }
        .product { border: 1px solid #ddd; margin: 10px; padding: 10px; display: flex; flex-direction: column; }
        .product-header { display: flex; align-items: center; margin-bottom: 10px; }
        .product img { width: 150px; height: 150px; margin-right: 20px; }
        .product-details { flex: 1; }
        .product-name { font-size: 1.2em; margin: 0; }
        .product-description { font-size: 0.9em; color: #555; margin: 5px 0; }
        .product-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .product-price { font-size: 1em; font-weight: bold; }
        .cart-btn { background-color: #26d48c; color: white; border: none; padding: 8px 20px; border-radius: 50px; cursor: pointer; text-align: center; }
        .cart-btn:disabled { background-color: gray; cursor: not-allowed; }
        #cart-container { margin-top: 20px; }
        #total-price { font-weight: bold; }
        #checkout-btn { background-color: #26d48c; color: white; border: none; padding: 10px 20px; border-radius: 50px; cursor: pointer; margin-top: 10px; }
        #account-details { display: none; border: 1px solid #ddd; padding: 20px; margin-top: 10px; background-color: #f9f9f9; }
        #payment-confirmation-btn { background-color: #25d366; color: white; border: none; padding: 10px 20px; border-radius: 50px; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Solar Products Store</h1>
    <input type="text" id="searchInput" placeholder="Search products...">
    <div id="productContainer"></div>
    <div id="cart-container">
        <h2>Shopping Cart</h2>
        <ul id="cart"></ul>
        <p id="total-price">Total: ₦0</p>
        <button id="checkout-btn">Checkout</button>
        <div id="account-details">
            <p><strong>Account Number:</strong> 1234567890</p>
            <p><strong>Account Name:</strong> Tasha Solar</p>
            <p><strong>Bank:</strong> Moniepoint</p>
            <button id="payment-confirmation-btn">I have made payment</button>
        </div>
    </div>

    <script>
        const products = [
            { id: 1, name: "1kVA Inverter", description: "A reliable inverter for small homes.", price: 140000, img: "img/tasha-1kva.jpeg" },
            { id: 2, name: "1.5kVA Inverter", description: "Great for powering appliances.", price: 180000, img: "img/tasha-1kva.jpeg" },
            { id: 3, name: "2kVA Inverter", description: "Suitable for medium-sized homes.", price: 230000, img: "img/tasha-2kva.jpeg" },
            // Add more products as needed...
        ];

        const cart = new Map();
        const productContainer = document.getElementById("productContainer");
        const searchInput = document.getElementById("searchInput");
        const cartElement = document.getElementById("cart");
        const totalPriceElement = document.getElementById("total-price");
        const checkoutBtn = document.getElementById("checkout-btn");
        const accountDetails = document.getElementById("account-details");
        const paymentConfirmationBtn = document.getElementById("payment-confirmation-btn");

        // Load saved cart on page load
        document.addEventListener('DOMContentLoaded', () => {
            const savedCart = JSON.parse(localStorage.getItem('cart'));
            if (savedCart) {
                savedCart.forEach(([id, item]) => cart.set(Number(id), item));
                renderCart();
            }
        });

        // Save cart to localStorage before the page unloads
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('cart', JSON.stringify(Array.from(cart.entries())));
        });

        // Display products
        function displayProducts(items) {
            productContainer.innerHTML = "";
            items.forEach(product => {
                const productDiv = document.createElement("div");
                productDiv.className = "product";

                const productHeader = document.createElement("div");
                productHeader.className = "product-header";

                const img = document.createElement("img");
                img.src = product.img;
                img.alt = product.name;
                img.loading = "lazy"; // Lazy loading for images

                const productDetails = document.createElement("div");
                productDetails.className = "product-details";

                const productName = document.createElement("h3");
                productName.className = "product-name";
                productName.textContent = product.name;

                const productDescription = document.createElement("p");
                productDescription.className = "product-description";
                productDescription.textContent = product.description;

                productDetails.append(productName, productDescription);
                productHeader.append(img, productDetails);

                const productFooter = document.createElement("div");
                productFooter.className = "product-footer";

                const productPrice = document.createElement("p");
                productPrice.className = "product-price";
                productPrice.textContent = `Price: ₦${product.price.toLocaleString()}`;

                const addToCartBtn = document.createElement("button");
                addToCartBtn.className = "cart-btn";
                addToCartBtn.textContent = "Add to Cart";
                addToCartBtn.onclick = () => addToCart(product);
                if (cart.has(product.id)) addToCartBtn.disabled = true;

                productFooter.append(productPrice, addToCartBtn);
                productDiv.append(productHeader, productFooter);
                productContainer.appendChild(productDiv);
            });
        }

        // Add product to cart
        function addToCart(product) {
            if (!cart.has(product.id)) {
                cart.set(product.id, { ...product, quantity: 1 });
            }
            renderCart();
            displayProducts(products);
        }

        // Render cart
        function renderCart() {
            cartElement.innerHTML = "";
            let totalPrice = 0;

            cart.forEach(item => {
                const cartItem = document.createElement("li");
                cartItem.textContent = `${item.name} - ₦${item.price.toLocaleString()} (Qty: ${item.quantity})`;

                const removeBtn = document.createElement("button");
                removeBtn.textContent = "Remove";
                removeBtn.style.marginLeft = "10px";
                removeBtn.onclick = () => removeFromCart(item.id);

                cartItem.appendChild(removeBtn);
                cartElement.appendChild(cartItem);
                totalPrice += item.price * item.quantity;
            });

            totalPriceElement.textContent = `Total: ₦${totalPrice.toLocaleString()}`;
        }

        // Remove product from cart
        function removeFromCart(productId) {
            cart.delete(productId);
            renderCart();
            displayProducts(products);
        }

        // Filter products on search
        let debounceTimer;
        searchInput.addEventListener("input", () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                const searchValue = searchInput.value.toLowerCase();
                const filteredProducts = products.filter(product => product.name.toLowerCase().includes(searchValue));
                displayProducts(filteredProducts);
            }, 300);
        });

        // Show account details on checkout
        checkoutBtn.addEventListener("click", () => {
            if (cart.size === 0) {
                alert("Your cart is empty. Add items before checking out.");
                return;
            }
            accountDetails.style.display = "block";
        });

        // Redirect to WhatsApp with order details
        paymentConfirmationBtn.addEventListener("click", () => {
            if (cart.size === 0) {
                alert("Your cart is empty. Add items before confirming payment.");
                return;
            }
            const whatsappUrl = generateWhatsAppMessage();
            window.open(whatsappUrl, "_blank");
        });

        // Generate WhatsApp order message
        function generateWhatsAppMessage() {
            let message = "Hello, I have made payment for the following items:\n\n";
            let totalPrice = 0;

            cart.forEach(item => {
                message += `- ${item.name} (Qty: ${item.quantity}) - ₦${(item.price * item.quantity).toLocaleString()}\n`;
                totalPrice += item.price * item.quantity;
            });

            message += `\nTotal Amount: ₦${totalPrice.toLocaleString()}\n\nThank you.`;

            const phoneNumber = "2341234567890"; // Replace with your WhatsApp number
            return `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
        }

        displayProducts(products);
    </script>
</body>
</html>
